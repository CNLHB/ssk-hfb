{"version":3,"sources":["webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/main.js","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?9b72","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?b958","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?02fd","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?fae9","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?3af0","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?aed9"],"names":["createPage","Page","components","paperList","loadMore","paperLeftPopup","uniSwipeAction","uniSwipeActionItem","computed","data","show","socketTask","is_open_socket","loadtext","list","$is_open_socket_paper","options","text","style","backgroundColor","onShow","userInfo","id","Vue","prototype","$is_open_socket","getChatList","sortChatList","onPullDownRefresh","uni","stopPullDownRefresh","onReachBottom","loadmore","onLoad","connectSocketInit","onNavigationBarButtonTap","e","index","navigateTo","url","showToast","title","icon","hidepopup","showpopup","onHide","console","log","beforeDestroy","closeSocket","methods","$http","setLoading","get","length","chatList","map","item","count","messages","reduce","prev","status","toId","fid","fromId","len","sendTime","time","gettime","Date","message","msgList","mItem","isme","uid","userpic","authorUrl","type","gstime","afterTime","username","noreadnum","setChatList","setStorageSync","JSON","stringify","onClick","delChatList","websocket","$socket","onOpen","res","onMessage","parse","i","msgIndex","put","mids","onClose","onError","close","success","fail","err","clickRequest","send","readMsg","setIndex","currentChatMsgs","msgs","filter","updateMsg","addfriend","clear"],"mappings":"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","file":"pages/paper/paper.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\nimport Vue from 'vue'\nimport Page from './pages/paper/paper.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./paper.vue?vue&type=template&id=1ec42b98&\"\nvar renderjs\nimport script from \"./paper.vue?vue&type=script&lang=js&\"\nexport * from \"./paper.vue?vue&type=script&lang=js&\"\nimport style0 from \"./paper.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue\"\nexport default component.exports","export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=template&id=1ec42b98&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport paperList from \"../../components/paper/paper-list.vue\";\nimport loadMore from \"../../components/common/load-more.vue\";\nimport paperLeftPopup from \"../../components/paper/paper-left-popup.vue\";\nimport time from '../../common/time.js'\nimport uniSwipeAction from '@/components/uni-swipe-action/uni-swipe-action.vue'\nimport uniSwipeActionItem from '@/components/uni-swipe-action-item/uni-swipe-action-item.vue'\nimport {\n\tmapMutations,\n\tmapState,\n\tmapGetters\n} from 'vuex'\nimport Vue from 'vue'\nexport default {\n\tcomponents: {\n\t\tpaperList,\n\t\tloadMore,\n\t\tpaperLeftPopup,\n\t\t        uniSwipeAction,\n\t\t        uniSwipeActionItem\n\t},\n\tcomputed: {\n\t\t...mapState(['chatList','msgIndex', 'userInfo','isPaper']),\n\t\t\t\t...mapGetters(['currentChatMsgs'])\n\t},\n\t\n\tdata() {\n\t\treturn {\n\t\t\tshow: false,\n\t\t\tsocketTask: null,\n\t\t\tis_open_socket: false,\n\t\t\tloadtext: \"\",\n\t\t\tlist: [],\n\t\t\t$is_open_socket_paper:false,\n\t\t\t      options:[\n\t\t\t        // {\n\t\t\t        //     text: '置顶',\n\t\t\t        //     style: {\n\t\t\t        //         backgroundColor: '#007aff'\n\t\t\t        //     }\n\t\t\t        // }, \n\t\t\t\t\t{\n\t\t\t            text: '删除',\n\t\t\t            style: {\n\t\t\t                backgroundColor: '#dd524d'\n\t\t\t            }\n\t\t\t        }\n\t\t\t      ]\n\t\t\t    \n\t\t};\n\t},\n\tonShow() {\n\t\tif (this.userInfo.id && Vue.prototype.$is_open_socket == false) {\n\t\t\tthis.getChatList()\n\t\t\tthis.loadtext = ''\n\t\t}else{\n\t\t\tthis.sortChatList()\n\t\t}\n\n\t},\n\t// 监听下拉刷新\n\tasync onPullDownRefresh() {\n\t\tawait this.getChatList()\n\t\tuni.stopPullDownRefresh();\n\t},\n\tonReachBottom() {\n\t\tthis.loadmore();\n\t},\n\tasync onLoad() {\n\t\tif (this.userInfo.id) {\n\t\t\tthis.connectSocketInit();\n\t\t\t\tthis.getChatList()\n\t\t\t\n\t\t} else {\n\t\t\tthis.loadtext = \"你还没登录!\"\n\t\t}\n\t},\n\t// 监听导航按钮点击事件\n\tonNavigationBarButtonTap(e) {\n\t\tswitch (e.index) {\n\t\t\tcase 0:\n\t\t\t\tif (this.userInfo.id) {\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\turl: '../user-list/user-list',\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"你还没登录！\",\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tthis.hidepopup();\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tthis.showpopup();\n\t\t\t\tbreak;\n\t\t}\n\t},\n\tonHide(){\n\t\tthis.$is_open_socket_paper= false\n\t\t\tconsole.log(\"关闭\")\n\t},\n\tbeforeDestroy() {\n\t\tthis.closeSocket();\n\t},\n\tmethods: {\n\t\t...mapMutations([\n\t\t\t'setChatList',\n\t\t\t'setIndex',\n\t\t\t'delChatList', \n\t\t\t'updateMsg',\n\t\t\t'addChatList',\n\t\t\t'sortChatList',\n\t\t\t'addChatMessage',\n\t\t\t'addNoreadMessage']),\n\t\tasync getChatList() {\n\t\t\tthis.$http.setLoading(false);\n\t\t\tlet data = await this.$http.get('chat/list');\n\t\t\tthis.$http.setLoading(true);\n\t\t\tif (data && data.length) {\n\t\t\t\tlet chatList = data.map((item) => {\n\t\t\t\t\tlet count = item.messages.reduce((prev, item) => {\n\t\t\t\t\t\tif (item.status == 0 && item.toId == this.userInfo.id) {\n\t\t\t\t\t\t\treturn prev + 1\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn prev\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 0)\n\t\t\t\t\tlet fid = this.userInfo.id == item.fromId ? item.toId : item.fromId\n\t\t\t\t\tlet len = item.messages.length - 1\n\t\t\t\t\tlet sendTime = item.messages[len] ?\n\t\t\t\t\t\ttime.gettime.gettime(item.messages[len].sendTime) :\n\t\t\t\t\t\ttime.gettime.gettime(new Date())\n\t\t\t\t\tlet message = item.messages[len] ? item.messages[len].message :\n\t\t\t\t\t\t''\n\t\t\t\t\tlet msgList= item.messages.map((mItem)=>{\n\t\t\t\t\t\t\treturn{\n\t\t\t\t\t\t\t\tid:mItem.id,\n\t\t\t\t\t\t\t\tisme:mItem.fromId==this.userInfo.id,\n\t\t\t\t\t\t\t\tuid:mItem.fromId==this.userInfo.id?mItem.fromId:mItem.toId,\n\t\t\t\t\t\t\t\tuserpic: mItem.fromId==this.userInfo.id?this.userInfo.authorUrl:item.userpic,\n\t\t\t\t\t\t\t\ttype:\"text\",\n\t\t\t\t\t\t\t\tmessage:mItem.message,\n\t\t\t\t\t\t\t\ttime:  time.gettime.gettime(mItem.sendTime),\n\t\t\t\t\t\t\t\tgstime:'',\n\t\t\t\t\t\t\t\tstatus: mItem.status,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: item.id,\n\t\t\t\t\t\tfid: fid,\n\t\t\t\t\t\tfromId: item.fromId,\n\t\t\t\t\t\ttoId: item.toId,\n\t\t\t\t\t\tafterTime: +new Date(item.afterTime),\n\t\t\t\t\t\tuserpic: item.userpic,\n\t\t\t\t\t\tusername: item.username,\n\t\t\t\t\t\ttime: sendTime,\n\t\t\t\t\t\tmessage: message,\n\t\t\t\t\t\tnoreadnum: count,\n\t\t\t\t\t\tmessages: msgList\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t// chatList.sort((a,b)=>{\n\t\t\t\t// \treturn  b.afterTime -a.afterTime\n\t\t\t\t// })\n\t\t\t\tthis.setChatList(chatList);\n\t\t\t\tthis.sortChatList()\n\t\t\t\tuni.setStorageSync('chatList', JSON.stringify(chatList))\n\t\t\t}\n\n\t\t},\n\t\tonClick(e,index){\n\t\t\tthis.delChatList(index)\n\t\t\t\n\t\t},\n\t\tasync connectSocketInit() {\n\t\t\tlet uid = this.userInfo.id\n\t\t\t// 创建一个this.socketTask对象【发送、接收、关闭socket都由这个对象操作】\n\t\t\tif (uid) {\n\t\t\t\tVue.prototype.$socket = await this.$http.websocket('GET', \"msg/\" + uid)\n\t\t\t\t// 消息的发送和接收必须在正常连接打开中,才能发送或接收【否则会失败】\n\t\t\t\tVue.prototype.$socket.onOpen((res) => {\n\t\t\t\t\tconsole.log(\"WebSocket连接正常打开中...！\");\n\t\t\t\t\tVue.prototype.$is_open_socket = true;\n\t\t\t\t\tif(Vue.prototype.$is_open_socket){\n\t\t\t\t\t\tVue.prototype.$socket.onMessage(async (res) => {\n\t\t\t\t\t\t\t\tconsole.log(\"收到消息并追加\")\n\t\t\t\t\t\t\t\tif(res.data===\"连接成功\"){\n\t\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet data = {}\n\t\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\t\tdata = JSON.parse(res.data);\n\t\t\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet index = -1;\n\t\t\t\t\t\t\t\tfor(let i =0;i<this.chatList.length;i++){\n\t\t\t\t\t\t\t\t\tif(this.chatList[i].toId == data.fromId){\n\t\t\t\t\t\t\t\t\t\tindex = i\n\t\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(index!=-1&& this.msgIndex==index){\n\t\t\t\t\t\t\t\t\tthis.$http.setLoading(false);\n\t\t\t\t\t\t\t\t\tthis.$http.put('chat/read', {\n\t\t\t\t\t\t\t\t\t\tmids: [data.id]\n\t\t\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\t\t\t\"content-type\": \"application/x-www-form-urlencoded\"\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\tthis.$http.setLoading(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.getChatList()\n\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t// 这里仅是事件监听【如果socket关闭了会执行】\n\t\t\t\tVue.prototype.$socket.onClose(() => {\n\t\t\t\t\tconsole.log(\"已经被关闭了\")\n\t\t\t\t})\n\t\t\t\tVue.prototype.$socket.onError((e) => {\n\t\t\t\t\tconsole.log(\"失败了\")\n\t\t\t\t\tconsole.log(e)\n\t\t\t\t})\n\t\t\t}\n\n\n\t\t},\n\t\t// 关闭websocket【离开这个页面的时候执行关闭】\n\t\tcloseSocket() {\n\t\t\tif (this.is_open_socket) {\n\t\t\t\tVue.prototype.$socket.close({\n\t\t\t\t\tsuccess(res) {\n\t\t\t\t\t\tthis.is_open_socket = false;\n\t\t\t\t\t\tconsole.log(\"关闭成功\", res)\n\t\t\t\t\t},\n\t\t\t\t\tfail(err) {\n\t\t\t\t\t\tconsole.log(\"关闭失败\", err)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tclickRequest() {\n\t\t\tif (this.is_open_socket) {\n\t\t\t\t// websocket的服务器的原理是:发送一次消息,同时返回一组数据【否则服务器会进去死循环崩溃】\n\t\t\t\tVue.prototype.$socket.send({\n\t\t\t\t\tdata: \"请求一次发送一次message\",\n\t\t\t\t\tasync success() {\n\t\t\t\t\t\tconsole.log(\"消息发送成功\");\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\treadMsg(index) {\n\t\t\tthis.setIndex(index)\n\t\t\tif (this.currentChatMsgs.length == 0) {\n\t\t\t\tconsole.log(this.currentChatMsgs)\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (this.chatList[index].noreadnum == 0) {\n\t\t\t\tconsole.log(this.chatList[index])\n\t\t\t\treturn\n\t\t\t}\n\t\t\tlet msgs = this.currentChatMsgs.filter((item => {\n\t\t\t\tif(item.id&&item.status==false){\n\t\t\t\t\treturn true\n\t\t\t\t}else{\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}));\n\t\t\tlet mids = msgs.map((item => {\n\t\t\t\treturn item.id\n\t\t\t}));\n\t\t\tthis.$http.put('chat/read', {\n\t\t\t\tmids: mids\n\t\t\t}, {\n\t\t\t\t\"content-type\": \"application/x-www-form-urlencoded\"\n\t\t\t})\n\t\t\tthis.updateMsg(index)\n\n\t\t},\n\t\t// 操作菜单\n\t\taddfriend() {\n\t\t\tconsole.log(\"加韩友\");\n\t\t\tuni.navigateTo({\n\t\t\t\turl:'../user-search/user-search'\n\t\t\t})\n\t\t\tthis.hidepopup();\n\t\t\t\n\t\t},\n\t\tclear() {\n\t\t\tconsole.log(\"清除缓存\");\n\t\t\tthis.hidepopup();\n\t\t},\n\t\thidepopup() {\n\t\t\tthis.show = false;\n\t\t},\n\t\tshowpopup() {\n\t\t\tthis.show = true;\n\t\t},\n\t\t// 上拉加载\n\t\tloadmore() {\n\t\t\tif (this.loadtext != \"\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// 修改状态\n\t\t\tthis.loadtext = \"加载中...\";\n\t\t\t// 获取数据\n\t\t\tthis.loadtext = \"没有更多数据了\";\n\t\t},\n\t}\n}\n","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1590679003679\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}