{"version":3,"sources":["webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/main.js","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?9b72","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?b958","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?02fd","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?fae9","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?3af0","webpack:///D:/桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue?aed9"],"names":["createPage","Page","Vue","prototype","$is_open_socket","components","paperList","loadMore","paperLeftPopup","computed","data","show","socketTask","is_open_socket","loadtext","list","onShow","userInfo","id","connectSocketInit","getChatList","onPullDownRefresh","uni","stopPullDownRefresh","onReachBottom","loadmore","onLoad","chatList","length","onNavigationBarButtonTap","e","index","navigateTo","url","showToast","title","icon","hidepopup","showpopup","beforeDestroy","closeSocket","methods","$http","setLoading","get","map","item","count","messages","reduce","prev","status","toId","fid","fromId","len","sendTime","time","gettime","Date","message","afterTime","userpic","username","noreadnum","sort","a","b","setChatList","console","log","setStorageSync","JSON","stringify","uid","websocket","$socket","onOpen","res","onMessage","onClose","onError","close","success","fail","err","clickRequest","send","readMsg","msgs","put","mids","updateMsg","addfriend","clear"],"mappings":"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","file":"pages/paper/paper.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\nimport Vue from 'vue'\nimport Page from './pages/paper/paper.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./paper.vue?vue&type=template&id=1ec42b98&\"\nvar renderjs\nimport script from \"./paper.vue?vue&type=script&lang=js&\"\nexport * from \"./paper.vue?vue&type=script&lang=js&\"\nimport style0 from \"./paper.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"桌面文件/mypro/韩府/韩府帮/韩府帮/pages/paper/paper.vue\"\nexport default component.exports","export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=template&id=1ec42b98&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport paperList from \"../../components/paper/paper-list.vue\";\nimport loadMore from \"../../components/common/load-more.vue\";\nimport paperLeftPopup from \"../../components/paper/paper-left-popup.vue\";\nimport time from '../../common/time.js'\nimport {\n\tmapMutations,\n\tmapState\n} from 'vuex'\nimport Vue from 'vue'\nVue.prototype.$is_open_socket = false\nexport default {\n\tcomponents: {\n\t\tpaperList,\n\t\tloadMore,\n\t\tpaperLeftPopup\n\t},\n\tcomputed: {\n\t\t...mapState(['chatList', 'userInfo'])\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshow: false,\n\t\t\tsocketTask: null,\n\t\t\tis_open_socket: false,\n\t\t\tloadtext: \"\",\n\t\t\tlist: []\n\t\t};\n\t},\n\tonShow() {\n\t\tif (this.userInfo.id && this.$is_open_socket == false) {\n\t\t\tthis.connectSocketInit();\n\t\t\tthis.getChatList()\n\t\t}\n\t\t\n\n\t},\n\t// 监听下拉刷新\n\tasync onPullDownRefresh() {\n\t\tawait this.getChatList()\n\t\tuni.stopPullDownRefresh();\n\t},\n\tonReachBottom() {\n\t\tthis.loadmore();\n\t},\n\tasync onLoad() {\n\t\tif (this.userInfo.id) {\n\t\t\tthis.connectSocketInit();\n\t\t\tif(this.chatList.length==0){\n\t\t\t\tthis.getChatList()\n\t\t\t}\n\t\t\t\n\t\t} else {\n\t\t\tthis.loadtext = \"你还没登录!\"\n\t\t}\n\t},\n\t// 监听导航按钮点击事件\n\tonNavigationBarButtonTap(e) {\n\t\tswitch (e.index) {\n\t\t\tcase 0:\n\t\t\t\tif (this.userInfo.id) {\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\turl: '../user-list/user-list',\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"你还没登录！\",\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tthis.hidepopup();\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tthis.showpopup();\n\t\t\t\tbreak;\n\t\t}\n\t},\n\tbeforeDestroy() {\n\t\tthis.closeSocket();\n\t},\n\tmethods: {\n\t\t...mapMutations(['setChatList', 'updateMsg']),\n\t\tasync getChatList() {\n\t\t\tthis.$http.setLoading(false);\n\t\t\tlet data = await this.$http.get('chat/list');\n\t\t\tthis.$http.setLoading(true);\n\t\t\tif (data && data.length) {\n\t\t\t\tlet chatList = data.map((item) => {\n\t\t\t\t\tlet count = item.messages.reduce((prev, item) => {\n\t\t\t\t\t\tif (item.status == 0 && item.toId == this.userInfo.id) {\n\t\t\t\t\t\t\treturn prev + 1\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn prev\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 0)\n\t\t\t\t\tlet fid = this.userInfo.id == item.fromId ? item.toId : item.fromId\n\t\t\t\t\tlet len = item.messages.length - 1\n\t\t\t\t\tlet sendTime = item.messages[len] ?\n\t\t\t\t\t\ttime.gettime.gettime(item.messages[len].sendTime) :\n\t\t\t\t\t\ttime.gettime.gettime(new Date())\n\t\t\t\t\tlet message = item.messages[len] ? item.messages[len].message :\n\t\t\t\t\t\t''\n\t\t\t\t\t\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: item.id,\n\t\t\t\t\t\tfid: fid,\n\t\t\t\t\t\tafterTime: +new Date(item.afterTime),\n\t\t\t\t\t\tuserpic: item.userpic,\n\t\t\t\t\t\tusername: item.username,\n\t\t\t\t\t\ttime: sendTime,\n\t\t\t\t\t\tmessage: message,\n\t\t\t\t\t\tnoreadnum: count,\n\t\t\t\t\t\tmessages: item.messages\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tchatList.sort((a,b)=>{\n\t\t\t\t\treturn  b.afterTime -a.afterTime\n\t\t\t\t})\n\t\t\t\tthis.setChatList(chatList);\n\t\t\t\tconsole.log(chatList)\n\t\t\t\tuni.setStorageSync('chatList', JSON.stringify(chatList))\n\t\t\t}\n\n\t\t},\n\t\tasync connectSocketInit() {\n\t\t\tlet uid = this.userInfo.id\n\t\t\t// 创建一个this.socketTask对象【发送、接收、关闭socket都由这个对象操作】\n\t\t\tif (uid) {\n\t\t\t\tVue.prototype.$socket = await this.$http.websocket('GET', \"msg/\" + uid)\n\t\t\t\t// 消息的发送和接收必须在正常连接打开中,才能发送或接收【否则会失败】\n\t\t\t\tVue.prototype.$socket.onOpen((res) => {\n\t\t\t\t\tconsole.log(\"WebSocket连接正常打开中...！\");\n\t\t\t\t\tVue.prototype.$is_open_socket = true;\n\t\t\t\t\t// 注：只有连接正常打开中 ，才能正常收到消息\n\t\t\t\t\tVue.prototype.$socket.onMessage((res) => {\n\t\t\t\t\t\tconsole.log(\"收到服务器内容：\" + res.data);\n\t\t\t\t\t\tconsole.log(\"执行数据加载\")\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t// 这里仅是事件监听【如果socket关闭了会执行】\n\t\t\t\tVue.prototype.$socket.onClose(() => {\n\t\t\t\t\tconsole.log(\"已经被关闭了\")\n\t\t\t\t})\n\t\t\t\tVue.prototype.$socket.onError((e) => {\n\t\t\t\t\tconsole.log(\"失败了\")\n\t\t\t\t\tconsole.log(e)\n\t\t\t\t})\n\t\t\t}\n\n\n\t\t},\n\t\t// 关闭websocket【离开这个页面的时候执行关闭】\n\t\tcloseSocket() {\n\t\t\tif (this.is_open_socket) {\n\t\t\t\tVue.prototype.$socket.close({\n\t\t\t\t\tsuccess(res) {\n\t\t\t\t\t\tthis.is_open_socket = false;\n\t\t\t\t\t\tconsole.log(\"关闭成功\", res)\n\t\t\t\t\t},\n\t\t\t\t\tfail(err) {\n\t\t\t\t\t\tconsole.log(\"关闭失败\", err)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tclickRequest() {\n\t\t\tif (this.is_open_socket) {\n\t\t\t\t// websocket的服务器的原理是:发送一次消息,同时返回一组数据【否则服务器会进去死循环崩溃】\n\t\t\t\tVue.prototype.$socket.send({\n\t\t\t\t\tdata: \"请求一次发送一次message\",\n\t\t\t\t\tasync success() {\n\t\t\t\t\t\tconsole.log(\"消息发送成功\");\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\treadMsg(index) {\n\n\t\t\tif (this.chatList[index].messages.length == 0) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (this.chatList[index].noreadnum == 0) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tlet msgs = this.chatList[index].messages.map((item => {\n\t\t\t\treturn item.id\n\t\t\t}));\n\t\t\tthis.$http.put('chat/read', {\n\t\t\t\tmids: msgs\n\t\t\t}, {\n\t\t\t\t\"content-type\": \"application/x-www-form-urlencoded\"\n\t\t\t})\n\t\t\tthis.updateMsg(index)\n\t\t},\n\t\t// 操作菜单\n\t\taddfriend() {\n\t\t\tconsole.log(\"加韩友\");\n\t\t\tuni.navigateTo({\n\t\t\t\turl:'../user-search/user-search'\n\t\t\t})\n\t\t\tthis.hidepopup();\n\t\t\t\n\t\t},\n\t\tclear() {\n\t\t\tconsole.log(\"清除缓存\");\n\t\t\tthis.hidepopup();\n\t\t},\n\t\thidepopup() {\n\t\t\tthis.show = false;\n\t\t},\n\t\tshowpopup() {\n\t\t\tthis.show = true;\n\t\t},\n\t\t// 上拉加载\n\t\tloadmore() {\n\t\t\tif (this.loadtext != \"\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// 修改状态\n\t\t\tthis.loadtext = \"加载中...\";\n\t\t\t// 获取数据\n\t\t\tthis.loadtext = \"没有更多数据了\";\n\t\t},\n\t}\n}\n","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./paper.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1590632830455\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}